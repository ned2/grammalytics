#!/usr/bin/env bash

PORT=5000
DEBUG=''

args=$(getopt -l "searchpath:" -o "s:h" -- "$@")
eval set -- "$args"

# process command line arguments
while [ $# -ge 1 ]; do
    case "$1" in
        --)
            # No more options left.
            shift
            break
            ;;
        -p|--port)
            PORT="$2"
            shift
            ;;
        -d|--debug)
            DEBUG="--debug-mode"
            ;;
        -h|--help)
            echo "run-web --port PORT --debug"
            exit 0
            ;;
    esac

    shift
done


SCRIPTPATH=$(cd $(dirname $0); pwd -P)
export PYTHONPATH=${SCRIPTPATH}:${PYTHONPATH}

mod_wsgi-express start-server \
                 --port ${PORT} \
                 ${DEBUG} \
                 --reload-on-changes \
                 --document-root www \
                 --directory-index index.html \
                 --entry-point wsgi.py
